<div class="contents-section">
  <div class="row no-gutters">

    <div class="col-lg-12 mb-30">
      <div class="card">
        <div class="card-header color-dark fw-500">
          <h3 class="card-header-section"><a href="#" class="breadcrumb-item"><i class="fas fa-home"></i> Home</a>
            <span class="breadcrumb-item active">Proforma Invoice and Payment Process</span>
          </h3>
          <div class="quotation-btn-section">
            <button type="button" title="Add New Proforma Invoice" class="btn btn-primary btn-default btn-squared"
              (click)="addDidGo()" style="margin-right: 30px;"><i class="fas fa-plus" style="margin-right:0;"></i>
            </button>
            <button type="button" class="btn btn-primary" data-toggle="modal" title="Search"
              data-target="#searchInvoiceFormId">
              <i class="fas fa-search" style="margin-right:0;"></i>
            </button>
          </div>
        </div>
        <div class="card-body">
          <div class="userDatatable global-shadow border-0 bg-white w-100">
            <div class="table-responsive">
              <table class="table mb-0 table-borderless">
                <thead>
                  <tr class="userDatatable-header">

                    <th>
                      <span class="userDatatable-title">Invoice No</span>
                    </th>

                    <th>
                      <span class="userDatatable-title">Cus Inv No</span>
                    </th>
                    <th>
                      <span class="userDatatable-title">Date</span>
                    </th>
                    <th>
                      <span class="userDatatable-title">Customer</span>
                    </th>

                    <th>
                      <span class="userDatatable-title">Total</span>
                    </th>
                    <th>
                      <span class="userDatatable-title">Curr Det</span>
                    </th>
                    <th>
                      <span class="userDatatable-title">Invoice Type</span>
                    </th>
                    <th>
                      <span class="userDatatable-title">Generated By</span>
                    </th>



                    <th>
                      <span class="userDatatable-title">Action</span>
                    </th>
                  </tr>
                </thead>
                <tbody>
                <tbody *ngFor="let list of DID_list; let i = index">


                  <td><span>{{ list.invoice_no}}</span>
                    <!-- <span><button type="button" class="buttonClass" [ngStyle]="{backgroundColor: list.colorCodes}">
                            {{list.billerCode}}
                          </button>
                        </span> -->
                    <span><button type="button" class="buttonClass {{
                          list.billerCode}}">{{
                        list.billerCode}}</button></span>

                  </td>
                  <td><span>{{ list.customerName}}</span></td>
                  <td><span>{{ list.billDate}}</span></td>
                  <td><span>{{ list.customerName}}</span></td>
                  <td><span>{{ list.netPayment}}</span></td>
                  <td><span>{{ list.currency_name}}</span>
                    <span><button type="button" class="buttonClass" [ngStyle]="{'background-color':'#FAFAD2'}">
                        {{list.conversionRate}}
                      </button>
                    </span>
                  </td>


                  <td><span>{{ list.export_type}}</span>
                    <span><button type="button" class="buttonClass" [ngStyle]="{'background-color':'#FDEDEC'}">
                        {{list.days}}
                      </button>
                    </span>
                  </td>
                  <td><span>{{ list.billGeneratedBy}}</span></td>

                  <td>
                    <div class="page">

                      <div class="dropdown">
                        <button class="btn1"><i class="fa fa-bars"></i></button>
                        <ul class="dropdown__list">

                          <li class="dropdown__item">
                            <a class="hover3" title="Edit" (click)="editDidGo(list.billId)">
                              <img class="show" src="assets/img/icon2/edit-blue.png">
                              <img class="hide" src="assets/img/icon2/edit-black.png">
                            </a>
                          </li>


                          <li class="dropdown__item">
                            <a class="hover4" title="Invoice sending method" data-toggle="modal"
                              data-target="#InvoiceSendingFormId">
                              <img class="show" src="assets/img/icon2/InvoicePost-blue.png">
                              <img class="hide" src="assets/img/icon2/InvoicePost-black.png">
                            </a>
                          </li>


                          <li class="dropdown__item">
                            <a class="hover4" title="Email" data-toggle="modal" data-target="#EmailFormId">
                              <img class="show" src="assets/img/icon2/gmail-blue.png">
                              <img class="hide" src="assets/img/icon2/gmail-black.png">
                            </a>
                          </li>

                          <li class="dropdown__item">
                            <a class="hover3" title="Payment" data-toggle="modal" data-target="#processPaymentFormId">
                              <img class="show" src="assets/img/icon2/payment-method1.png">
                              <img class="hide" src="assets/img/icon2/payment-method.png">
                            </a>
                          </li>
                          <li class="dropdown__item">
                            <a class="hover4" title="Delete" data-toggle="modal" data-target="#DeleteInvoice">
                              <img class="show" src="assets/img/icon2/delete-blue.png">
                              <img class="hide" src="assets/img/icon2/delete-black.png">
                            </a>
                          </li>
                          <li class="dropdown__item">
                            <a class="hover3" title="Email-Landscape" data-toggle="modal" data-target="#emailFormId">
                              <img class="show" src="assets/img/icon2/gmail-blue.png">
                              <img class="hide" src="assets/img/icon2/gmail-black.png">
                            </a>
                          </li>
                          <li class="dropdown__item">
                            <a href="#" class="hover4" title="Coupon Assign" data-toggle="modal"
                              data-target="#couponAssignFormId">
                              <img class="show" src="assets/img/icon2/coupon.png">
                              <img class="hide" src="assets/img/icon2/coupon-black.png">
                            </a>
                          </li>
                          <li class="dropdown__item">
                            <a href="#" class="hover3" title="PI to Invoice Conversion" data-toggle="modal"
                              data-target="#PItoInvoiceConversionFormId">
                              <img class="show" src="assets/img/icon2/invoice-pi.png">
                              <img class="hide" src="assets/img/icon2/invoice-pi.png">
                            </a>
                          </li>
                          <li class="dropdown__item">
                            <a class="hover4" title="PDF" data-toggle="modal" data-target="#pdfFormId">
                              <img class="show" src="assets/img/icon2/pdf-blue.png">
                              <img class="hide" src="assets/img/icon2/pdf-black.png">
                            </a>
                          </li>


                          <li class="dropdown__item">
                            <a href="#" class="hover4" title="Share Permission" data-toggle="modal"
                              data-target="#sharePerissionFormId" (click)="invoiceSharedPersonEdit(list.billId)">
                              <img class="show" src="assets/img/icon2/share-square-blue.png">
                              <img class="hide" src="assets/img/icon2/share-square-black.png">
                            </a>
                          </li>

                          <!-- <li class="dropdown__item">
                                  <a href="#" class="hover4" title="Share Permission"
                                  data-toggle="modal" data-target="#sharePerissionFormId"
                                  
                                  (click)="quotationSharedPersonEdit(list.billId)">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24"
                                      fill="none" stroke="#009688" stroke-width="3" stroke-linecap="round"
                                      stroke-linejoin="round" class="feather feather-edit-3">
                                      <path d="M21,21V20c0-2.76-4-5-9-5s-9,2.24-9,5v1"/>
                                      <path d="M16,6.37A4,4,0,1,1,12.63,3,4,4,0,0,1,16,6.37Z"/>
                                    </svg>
                                  </a>
                                </li> -->


                          <li class="dropdown__item">
                            <a class="hover3" title="show permission" data-toggle="modal"
                              data-target="#showPerissionFormId">
                              <img class="show" src="assets/img/icon2/perm.png">
                              <img class="hide" src="assets/img/icon2/perm.png">
                            </a>
                          </li>
                          <li class="dropdown__item">
                            <a class="hover4" title="set Invoice Type Name" data-toggle="modal"
                              data-target="#setInvoiceTypeNameFormId" (click)="setInvoiceTypeNameEdit(list.billId)">
                              <img class="show" src="assets/img/icon2/invoicetpe.png">
                              <img class="hide" src="assets/img/icon2/invoicetpe.png">
                            </a>
                          </li>
                          <li class="dropdown__item">
                            <a class="hover3" title="set Terms & Condition" data-toggle="modal"
                              data-target="#settermsConditionFormId" (click)="setTermsConditionEdit(list.billId)">
                              <img class="show" src="assets/img/icon2/TermsConditions-blue.png">
                              <img class="hide" src="assets/img/icon2/TermsConditions-black.png">
                            </a>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </td>
                </tbody>
              </table>
            </div>
          </div>
          <br>
          <nav class="atbd-page">
            <ul class="pagination mb-0" *ngIf="paginationData.info == 'show'">
              <li class="page-item">
                <a [class]="paginationData.backtab=='show' ? 'page-link' :'page-link disabled'"
                  href="javascript:void(0)"
                  (click)="paginationData.backtab=='show' ? getInvoice({'offset':paginationData.start}) : false"><i
                    class="fas fa-angle-left"></i></a>
              </li>
              <li class="page-item" *ngIf="paginationData.backtab =='show'">
                <a class="page-link" href="javascript:void(0)" (click)="getInvoice({'offset':paginationData.back})"><i
                    class="fas fa-angle-double-left"></i></a>
              </li>
              <li [class]="pagination.load ==false ? 'page-item active' :'page-item'"
                *ngFor="let pagination of paginationData.data;let i=index">
                <a class="page-link" href="javascript:void(0)"
                  (click)=" pagination.load ==true ? getInvoice({'offset':pagination.offset_count}) : false">{{pagination.btn_length}}
                  <span class="sr-only" *ngIf="pagination.load ==false">(current)</span></a>
              </li>
              <li class="page-item" *ngIf="paginationData.nexttab =='show'">
                <a class="page-link" href="javascript:void(0)" (click)="getInvoice({'offset':paginationData.next})"><i
                    class="fas fa-angle-double-right"></i></a>
              </li>
              <li class="page-item">
                <a [class]="paginationData.nexttab =='show' ? 'page-link' : 'page-link disabled'"
                  href="javascript:void(0)"
                  (click)="paginationData.nexttab =='show' ? getInvoice({'offset':paginationData.end}) : false"><i
                    class="fas fa-angle-right"></i></a>
              </li>
              <li class="dropdown__item">
                <a class="hover3" title="Testing Payment Link" data-toggle="modal" data-target="#">

                </a>
              </li>
            </ul>
          </nav>
          <br>
          <br>
          <table border="0" cellspacing="0" cellpadding="0">
            <tbody>
              <tr>
                <td width="20" bgcolor="#d0ffc3">&nbsp;</td>
                <td width="100" style="padding-left:20px;">Paid </td>
                <td width="20" bgcolor="#fffeb3">&nbsp;</td>
                <td width="100" style="padding-left:20px;">Partial Paid</td>
                <td width="20" bgcolor="#ffb8b8">&nbsp;</td>
                <td width="100" style="padding-left:20px;"> Not Paid </td>
                <td width="20" bgcolor="#FA600C">&nbsp;</td>
                <td width="100" style="padding-left:20px;"> Cancel </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </div>
</div>

<!---------------------- set Invoice Type Name pop up start  -------------------------->

<div class="modal fade" id="setInvoiceTypeNameFormId" tabindex="-1" role="dialog"
  aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Invoice Type Details
        </h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="setInvoiceType">
          <div class="row">
            <div class="col-lg-12" style="display: flex;">
              <div class="col-lg-4">
                <label>Select Invoice Type</label>
              </div>
              <div class="col-lg-6">
                <select class="form-control" formControlName="setInvoice">
                  <option [ngValue]="null" selected disabled>Select invoice From</option>

                  <option *ngFor="let invTy of InvoiceTypeList" value="{{invTy}}">
                    {{invTy}}
                  </option>
                </select>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-primary" (click)="setInvoiceTypeNameUpdate()">Update</button>
        <button type="button" class="btn btn-dark" data-dismiss="modal" (click)="setInvoiceTypeClear()">
          Cancel
        </button>

      </div>
    </div>
  </div>
</div>

<!------------------- set Invoice Type Name pop up end ---------------->

<!------------------------ set Terms & Condition pop up start  ---------->

<div class="modal fade" id="settermsConditionFormId" tabindex="-1" role="dialog"
  aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Terms Condition Details
        </h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="setTermCondition">
          <div class="row">
            <div class="col-lg-12" style="display: flex;">
              <div class="col-lg-4">
                <label>Terms Condition </label>
              </div>
              <div class="col-lg-6">
                <select class="form-control" formControlName="setTerm">
                  <option [ngValue]="null" selected disabled>Select term Condition</option>

                  <option *ngFor="let term of TermDetailsList" value="{{term}}">
                    {{term}}
                  </option>
                </select>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-primary" (click)="setTermsConditionUpdate()">Update</button>
        <button type="button" class="btn btn-dark" data-dismiss="modal" (click)="setTermsConditionClear()">
          Cancel
        </button>

      </div>
    </div>
  </div>
</div>


<!------------------------------------- start invoice send method  -------------------------->

<div class="modal fade" id="InvoiceSendingFormId" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" style="margin-left: 145px;">Invoice Sending Method
        </h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="InvoiceSendingMethod">
          <div class="row">
            <div class="col-lg-12" style="display: flex;">
              <div class="col-lg-4">
                <label>Select invoice sending type</label>
              </div>
              <div class="col-lg-6">

                <div class="form-check form-check-inline">

                  <input class="form-check-input" type="radio" name="post_send_status" id="post_send_status_post"
                    value="1" checked>
                  <label class="form-check-label" for="exampleRadios1">
                    By Post
                  </label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="post_send_status" id="post_send_status_mail"
                    value="3">
                  <label class="form-check-label" for="exampleRadios2">
                    By Email
                  </label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="post_send_status" id="post_send_status_none"
                    value="0">
                  <label class="form-check-label" for="exampleRadios3">
                    None
                  </label>
                </div>

              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-primary">save</button>
        <button type="button" class="btn btn-dark" data-dismiss="modal">
          Cancel
        </button>

      </div>
    </div>
  </div>
</div>

<!-------------------------------------------- end invoice send method -------------------------->

<!-------------------------------------------- start Share permission -------------------------->
<div class="modal fade" id="sharePerissionFormId" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="invoiceAttachModalLongTitle">Select Shared Person</h2>

        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="SharePermission">

          <div class="">
            <div class="row">
              <div class="d-flex col-lg-4" *ngFor="let quot of quotationSharedPerson_List;let i =index">
                <div class="d-flex">
                  <div class="">
                    <div class="checkbox-group-wrapper">
                      <div class="checkbox-group d-flex">
                        <div class="checkbox-theme-default custom-checkbox checkbox-group__single d-flex">
                          <input class="checkbox" type="checkbox" id="check-grp1-{{i}}"
                            (change)="EditCHK(quot.userId,$event)">
                          <label for="check-grp1-{{i}}"></label>
                        </div>
                      </div>
                    </div>
                  </div>

                </div>

                <span class="">{{quot.firstName}}</span>

              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-primary" (click)="invoiceSharedPersonUpdate()">save</button>
        <button type="button" class="btn btn-dark" data-dismiss="modal">
          Cancel
        </button>

      </div>
    </div>
  </div>
</div>
<!-------------------------------------------- end Share permission -------------------------->



<!----------Modal Pop Up (BEGIN)  for advanced search Quotation ------------------>
<div class="modal fade" id="searchInvoiceFormId" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" role="document">
    <div class="modal-content searchQuotationCSS">
      <div class="modal-header">
        <h2 class="col-12 col-12 modal-title text-center text-center " id="invoiceAttachModalLongTitle">Advanced search
        </h2>


        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="searchInvoiceForm">
          <div class="row">
            <div class="col-lg-3 searchScrollCss">
              <div class="form-group">
                <label for="temp1" class="col-lg-12 ">Biller Name</label>
                <div class="col-lg-12 " *ngFor="let biller of biller_list;let i =index">
                  <input type="checkbox" id="{{biller.billerId}}" formControlName="search_billerName"
                    (change)="searchBillerNameCHK(biller.billerId,$event)">

                  {{biller.billerName}}
                </div>
              </div>
            </div>
            <div class="col-lg-3">
              <div class="form-group row">
                <div class="ng-autocomplete">
                  <label for="companyName" class="col-lg-12 ">Search Text</label>
                  <ng-autocomplete [data]="searchResult" [searchKeyword]="keywordCompanyName"
                    formControlName="company_Name" (selected)='selectEventCustomer($event)'
                    (inputChanged)='searchCustomerData($event)' (inputFocused)='onFocusedCustomer($event)'
                    [itemTemplate]="itemTemplateCustomer" [notFoundTemplate]="notFoundTemplate">
                  </ng-autocomplete>

                  <ng-template #itemTemplateCustomer let-item>
                    <a [innerHTML]="item.customerName"></a>
                  </ng-template>

                  <ng-template #notFoundTemplate let-notFound>
                    <div [innerHTML]="notFound"></div>
                  </ng-template>
                </div>

              </div>
            </div>
            <div class="col-lg-2 searchScrollCss">
              <div class="form-group">
                <label for="temp1" class="col-lg-12 ">Years</label>
                <div class="col-lg-12 " *ngFor="let yrs of yearsList;let i =index">
                  <input type="checkbox" id="{{yrs}}" formControlName="years" (change)="yearsCHK(yrs,$event)">
                  <!-- <input type="checkbox"> -->

                  {{yrs}}
                </div>
              </div>
            </div>

            <div class="col-lg-4 searchScrollCss">
              <div class="form-group">
                <label for="temp1" class="col-lg-12 ">Others</label>
                <!-- <div class="col-lg-12 " *ngFor="let srs of searchOthers;let i =index">
                  
                  <input type="checkbox" id="{{srs}}"
                  formControlName="others"  (change)="SearchOtherCheckAllCHK(srs,$event)">
                  {{srs}}
                </div> -->
                <div class="col-lg-12 ">

                  <input type="checkbox" formControlName="recurring_only" (change)="recurring_onlyCHK($event)">
                  Select Recuring Only
                  <br>
                  <input type="checkbox" formControlName="dont_select_did_invoice"
                    (change)="dont_select_did_invoiceCHK($event)">
                  Don't Select DID Invoice <br>
                  <input type="checkbox" formControlName="RevenueTypeWiseShow"
                    (change)="RevenueTypeWiseShowCHK($event)">
                  Revenue Type Wise Show
                </div>
                <div class="col-lg-12" *ngIf="(CBV_RevenueTypeWiseShow==true)">
                  <select id="revenueType" class="form-control" (change)="handleChange_RevenueTypeWiseShow($event)"
                    formControlName="revenueTypewiseCBKshow">
                    <option [ngValue]="null" selected>Select Invoice Type</option>
                    <option *ngFor="let rev of revenueTypeList" value="{{rev.revenue_type_id}}">
                      {{rev.revenue_type_name}}
                    </option>
                  </select>
                </div>
              </div>
            </div>




          </div>
        </form>

      </div>
      <div class="modal-footer">

        <button type="button" class="btn btn-primary" (click)="getInvoice({})">
          Search
        </button>
        <button type="button" class="btn btn-dark" data-dismiss="modal">
          Close
        </button>
      </div>
    </div>
  </div>
</div>
<!----------Modal Pop Up (END)  for advanced search Quotation ------------------>