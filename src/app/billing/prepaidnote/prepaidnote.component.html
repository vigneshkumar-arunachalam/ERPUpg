<div class="contents-section">

    <div class="row no-gutters">
      <div class="col-lg-12 mb-30">
        <div class="card quotation">
          <div class="card-header color-dark fw-500">
            <h3 class="card-header-section"><a href="#" class="breadcrumb-item"><i class="fas fa-home"></i> Home</a>
              <span class="breadcrumb-item active">Prepaid Note</span>
            </h3>
  
  
            <div class="quotation-btn-section">
              <button *ngIf="Transaction_list_PermissAdd==1" type="button" title="Add Prepaid Note" class="btn btn-primary btn-default btn-squared"
                (click)="addCreditNoteGo()" style="margin-right: 10px;">
                <i class="fas fa-plus" style="margin-right:4px;"></i>
                Add
              </button>
              <button *ngIf="Transaction_list_PermissSearch==1" type="button" class="btn btn-primary" data-toggle="modal" title="Search"
                data-target="#searchTransactionFormId" (click)="clearSearch()">
                <i class="fas fa-search" style="margin-right:4px;"></i>Search
              </button>
            </div>
          </div>
          <div class="card-body">
            <div class="userDatatable global-shadow border-0 bg-white w-100">
              <div class="table-responsive">
                <table class="table mb-0 table-borderless">
                  <thead>
                    <tr class="userDatatable-header">
  
                      <th>
                        <span class="userDatatable-title">Doc No</span>
                      </th>
  
                      <th>
                        <span class="userDatatable-title">Date</span>
                      </th>
                      <th>
                        <span class="userDatatable-title">Biller</span>
                      </th>
                      <th>
                        <span class="userDatatable-title">Customer Name</span>
                      </th>
  
                      <th>
                        <span class="userDatatable-title">Total Amt</span>
                      </th>
                      <th>
                        <span class="userDatatable-title">Tax Amt</span>
                      </th>
                      <th>
                        <span class="userDatatable-title">Net Total Amt</span>
                      </th>
                      <th>
                        <span class="userDatatable-title">Bal Amt</span>
                      </th>
  
                      <th>
                        <span class="userDatatable-title">Generated By</span>
                      </th>
  
                      <th>
                        <span class="userDatatable-title">Action</span>
                      </th>
                    </tr>
                  </thead>
                  <tbody>
  
                    <tr *ngFor="let list of Transaction_list; let i = index"
                      [ngStyle]="{'background-color':(list.status=='1') ? ('#AFF7B2 ') : ( (list.status=='2') ? ('#d0ffc3') : ( (list.status=='3') ? ('#F26969') : ('Default')) )}">
  
                      <td>
                        <span>{{ list.doc_no}}</span>
                      </td>
                      <td>
                        <span>{{ list.date}}</span>
                      </td>
  
  
                      <td>
                        <span><button type="button" class="buttonClass {{
                                                              list.billerCode}}">{{
                            list.billerCode}}</button></span>
  
                      </td>
                      <td>
                        <span>{{ list.customer_name}}</span>
                      </td>
                      <td>
                        <span>{{ list.total_amt}}</span>
                      </td>
  
                      <td>
                        <span>{{ list.tax_amt}}</span>
                      </td>
  
  
                      <td>
                        <span>{{ list.net_total_amt}}</span>
                      </td>
                      <td>
                        <span>{{ list.balance_amt}}</span>

                      </td>
                      <td>
  
                        <span>{{ list.generated_by}}</span>
                      </td>
                      <td>
                        <div class="page">
  
                          <div class="dropdown">
                            <button class="btn1"><i class="fa fa-bars"></i></button>
                            <ul class="dropdown__list">

  
                              <li class="dropdown__item" *ngIf="Transaction_list_PermissEdit==1">
                                <a class="hover1" title="Edit"
                                  (click)=" editCreditNoteGo(list.prepaid_id)">
                                  <img class="show" src="assets/img/icon/nfc-pen-b.png">
                                  <img class="hide" src="assets/img/icon/nfc-pen.png">
                                </a>
  
                              </li>
  
                              <li class="dropdown__item" *ngIf="Transaction_list_PermissDelete==1">
                                <a class="hover1" title="Delete" data-toggle="modal"
                                  (click)="deleteTransaction(list.prepaid_id)">
                                  <img class="show" src="assets/img/icon/remove-b.png">
                                  <img class="hide" src="assets/img/icon/remove.png">
                                </a>
                              </li>
  
                              <li class="dropdown__item" *ngIf="Transaction_list_PermissEmail==1">
                                <a class="hover1" title="Email" data-toggle="modal"
                                (click)="getEmailDetails(list.prepaid_id,list.customer_id)"
                                  data-target="#emailFormId_prepaidNote">
                                  <img class="show" src="assets/img/icon2/gmail-blue.png">
                                  <img class="hide" src="assets/img/icon2/gmail-black.png">
                                </a>
                              </li>
                              <li class="dropdown__item" *ngIf="Transaction_list_PermissPDF==1">
                                <a class="hover1" title="PDF"   (click)="PDF(list.prepaid_id)">
                                  <img class="show" src="assets/img/icon2/pdf-blue.png">
                                 <img class="hide" src="assets/img/icon2/pdf-black.png">
                                </a>
                              </li>
  
                            </ul>
                          </div>
                        </div>
                      </td>
                    </tr>
  
  
                  </tbody>
                </table>
              </div>
            </div>
            <br>
            <nav class="atbd-page">
              <ul class="pagination mb-0" *ngIf="paginationData.info == 'show'">
                <li class="page-item">
                  <a [class]="paginationData.backtab=='show' ? 'page-link' :'page-link disabled'"
                    href="javascript:void(0)"
                    (click)="paginationData.backtab=='show' ? getTransactionNewList({'offset':paginationData.start}) : false"><i
                      class="fas fa-angle-left"></i></a>
                </li>
                <li class="page-item" *ngIf="paginationData.backtab =='show'">
                  <a class="page-link" href="javascript:void(0)"
                    (click)="getTransactionNewList({'offset':paginationData.back})"><i
                      class="fas fa-angle-double-left"></i></a>
                </li>
                <li [class]="pagination.load ==false ? 'page-item active' :'page-item'"
                  *ngFor="let pagination of paginationData.data;let i=index">
                  <a class="page-link" href="javascript:void(0)"
                    (click)=" pagination.load ==true ? getTransactionNewList({'offset':pagination.offset_count}) : false">{{pagination.btn_length}}
                    <span class="sr-only" *ngIf="pagination.load ==false">(current)</span></a>
                </li>
                <li class="page-item" *ngIf="paginationData.nexttab =='show'">
                  <a class="page-link" href="javascript:void(0)"
                    (click)="getTransactionNewList({'offset':paginationData.next})"><i
                      class="fas fa-angle-double-right"></i></a>
                </li>
                <li class="page-item">
                  <a [class]="paginationData.nexttab =='show' ? 'page-link' : 'page-link disabled'"
                    href="javascript:void(0)"
                    (click)="paginationData.nexttab =='show' ? getTransactionNewList({'offset':paginationData.end}) : false"><i
                      class="fas fa-angle-right"></i></a>
                </li>
                <li class="dropdown__item">
                  <a class="hover3" title="Testing Payment Link" data-toggle="modal" data-target="#">
  
                  </a>
                </li>
              </ul>
            </nav>
            <br>
            <br>
            <table border="0" cellspacing="0" cellpadding="0">
              <tbody>
                <tr style="background-color: bisque;">
                  <td width="20" bgcolor="#FFF" style="border:1px solid #d0d0d0">&nbsp;</td>
                  <td width="160" style="padding-left:10px">Waiting for approval </td>
                  <td width="20" bgcolor="#AFF7B2">&nbsp;</td>
                  <td width="100" style="padding-left:10px">Approved</td>
                  <td width="20" bgcolor="#F26969">&nbsp;</td>
                  <td width="20" style="padding-left:10px">Rejected</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  
  </div>
  
  

  
  

  
  
  <!----------Modal Pop Up (BEGIN)  for advanced search Quotation ------------------>
  <div class="modal fade" id="searchTransactionFormId" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" role="document">
      <div class="modal-content searchQuotationCSS">
        <div class="modal-header">
  
          <h2 class="col-11  modal-title text-center text-center" id="exampleModalLongTitle" style="font-family: cursive;color:rgb(240 241 219);background: #200122; /* fallback for old browsers */
           background: -webkit-linear-gradient(to right, #200122, #6f0000); /* Chrome 10-25, Safari 5.1-6 */
           background: linear-gradient(to right, #262127, #54b7aa);">
            Advanced Search </h2>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form [formGroup]="searchTransactionForm">
            <div class="col-lg-12">
              <div class="form-group row">
                <div class="ng-autocomplete">
                  <label for="companyName" class="col-lg-12 col-form-label">Search Text</label>
                  <ng-autocomplete [data]="searchResult" [searchKeyword]="keywordCompanyName"
                  formControlName="search_billerName1"
                    (selected)='selectEventCustomer($event)' (inputChanged)='searchCustomerData($event)'
                    (inputFocused)='onFocusedCustomer($event)' [itemTemplate]="itemTemplateCustomer"
                    (inputCleared)="clearSelection($event)" [notFoundTemplate]="notFoundTemplate">
                  </ng-autocomplete>

                  <ng-template #itemTemplateCustomer let-item>
                    <a [innerHTML]="item.customerName"></a>
                  </ng-template>

                  <ng-template #notFoundTemplate let-notFound>
                    <div [innerHTML]="notFound"></div>
                  </ng-template>

                </div>


              </div>
            </div>
           
          </form>
  
        </div>
        <div class="modal-footer">
  
          <button type="button" class="btn btn-primary" (click)="getTransactionNewList({})">
            Search
          </button>
          <button type="button" class="btn btn-dark" data-dismiss="modal">
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
  <!----------Modal Pop Up (END)  for advanced search Quotation ------------------>


    <!-----------------Modal Pop Up (BEGIN) Email-Landscape------------------>

    <div class="modal fade" id="emailFormId_prepaidNote" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" role="document">
      <div class="modal-content">
        <div class="modal-header">
          
          <h2 class="col-11  modal-title text-center text-center" id="exampleModalLongTitle" style="font-family: cursive;color:rgb(240 241 219);background: #200122; /* fallback for old browsers */
          background: -webkit-linear-gradient(to right, #200122, #6f0000); /* Chrome 10-25, Safari 5.1-6 */
          background: linear-gradient(to right, #262127, #54b7aa);">
          Email</h2>

          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form [formGroup]="emailForm">

            <div class="col-md-12 col-12">
              <div class="form-group row">
                <label for="emailFrom" class="col-lg-2 col-form-label"><span>From</span> :</label>
                <div class="col-lg-10">
                  <select name="templat" id="emailFrom" class="form-control" formControlName="email_From"
                    change="handle__email_from($event)">
                    <option [ngValue]="null" selected>Select From</option>
                    <option *ngFor="let from of email_fromList" value="{{ from.from_email }}">
                      {{ from.from_email }}
                    </option>
                    <!-- <option *ngFor="let from of email_fromList" value="{{ from.email_from_id }}">
                    {{ from.from_email }}
                  </option> -->
                  </select>
                  <div class="alert alert-danger alertdangerCustomCSS1  mt-2"
                    *ngIf="emailForm.controls['email_From'].invalid && emailForm.controls['email_From'].touched">
                    Please
                    enter From Address
                  </div>
                </div>
              </div>

            </div>


            <div class="col-md-12 col-12">
              <div class="form-group row">
                <label for="emailto" class="col-lg-2 col-form-label"><span>Select To Type</span> :</label>
                <div class="col-md-9 col-9" style="display: flex;">
                  <div class="form-check" style="margin-right: 10px;">
                    <input mdbRadio class="form-check-input" type="radio" 
                      name="radio_ApprovalBy" id="company_prepaid" (change)="handle_radioChange_email($event);" />

                    <label class="form-check-label" for="company_prepaid"> Company
                    </label>
                  </div>

                  <div class="form-check">
                    <input mdbRadio class="form-check-input" type="radio" 
                      name="radio_ApprovalBy" id="finance_prepaid" [checked]="true"
                      (change)="handle_radioChange_email($event)" />
                    <label class="form-check-label" for="finance_prepaid">Finance
                    </label>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-12 col-12">
              <div class="form-group row">
                <label for="emailto" class="col-lg-2 col-form-label"><span>To </span>:</label>
                <div class="col-lg-10">
                  <input type="email" id="emailto" class="form-control" formControlName="email_to">
                  <div class="alert alert-danger alertdangerCustomCSS1  mt-2"
                    *ngIf="emailForm.controls['email_to'].invalid && emailForm.controls['email_to'].touched">
                    Please
                    enter To Address
                  </div>
                </div>
              </div>

            </div>
           
        

            <div class="col-md-12 col-12">
              <div class="form-group row">
                <label for="subject" class="col-lg-2 col-form-label"><span>Subject</span> :</label>
                <div class="col-lg-10">
                  <input type="text" id="subject9" class="form-control" formControlName="Subject_Content">
                  <div
                    *ngIf="emailForm.controls['Subject_Content'].invalid && (emailForm.controls['Subject_Content'].dirty || emailForm.controls['Subject_Content'].touched)"
                    class="alert alert-danger alertdangerCustomCSS1 mt-2">
                    Subject is Required
                  </div>
                </div>
              </div>

            </div>
            <div class="col-md-12 col-12" >
              <div class="form-group row">
                <label for="template" class="col-lg-2 col-form-label"><span>Template</span> :</label>
                <div class="col-lg-10">
                  <select name="templat" id="template" class="form-control" formControlName="email_template"
                    (change)="templateContentEmailDropdown($event)">
                    <option [ngValue]="null" selected>Select Template</option>
                    <option *ngFor="let template of email_crmTemplateList" value="{{ template.crm_template_id }}">
                      {{template.crm_template_name}}
                    </option>
                  </select>
                  <br>

                  <div
                    *ngIf="emailForm.controls['email_template'].invalid && (emailForm.controls['email_template'].dirty || emailForm.controls['email_template'].touched)"
                    class="alert alert-danger alertdangerCustomCSS1 ">
                    Template is Required
                  </div>
                </div>


              </div>
            </div>
            <div class="col-md-12 col-12">
              <div class="form-group row">
                <label for="subject" class="col-lg-2 col-form-label"><span>Message</span> :</label>
                <div class="col-lg-10">
                  <editor id="tinyID1_prepaidnote" [init]="{
                                base_url: '/tinymce', 
                                branding: false,
                                suffix: '.min'
                                    
                            }"></editor>
                </div>
              </div>
            </div>
            <!-- <div class="col-md-12 col-12">
                        <div class="form-group row">
                            <label for="Attachment" class="col-lg-2 col-form-label"><span>Attachment</span> :</label>

                        </div>
                    </div> -->

          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" (click)="sendMail()">Send
            Mail

          </button>
          <button type="button" class="btn btn-dark" data-dismiss="modal" (click)="PIEmailClear()">
            Close
          </button>

        </div>
      </div>
    </div>
  </div>

  <!-------------- Email-Landscape Pop up ends------------------------------------------>

